
global lifes;

% lifes = [0.014 0.034 0.059 0.061 0.069 0.080 0.123 0.142 0.165 0.210 0.381 0.464 0.479 0.556 0.574 0.839 0.917 0.969 0.991 1.064 1.088 1.091 1.174 1.270 1.275 1.355 1.397 1.477 1.578 1.649 1.702 1.893 1.932 2.001 2.161 2.292 2.326 2.337 2.628 2.785 2.811 2.886 2.993 3.122 3.248 3.715 3.790 3.857 3.912 4.100 4.106 4.116 4.315 4.510 4.584 5.267 5.299 5.583 6.065 9.701];
% lifes = [0.058 0.070 0.090 0.105 0.113 0.121 0.153 0.159 0.224 0.421 0.570 0.596 0.618 0.834 1.019 1.104 1.497 2.027 2.234 2.372 2.433 2.505 2.690 2.877 2.879 3.166 3.455 3.551 4.378 4.872 5.085 5.272 5.341 8.952 9.188 11.399];
% lifes = [0.01 0.01 0.01 0.01 0.01 0.01 0.02 0.02 0.02 0.02 0.03 0.04 0.06 0.08 0.10 0.10 0.12 0.12 0.12 0.13 0.14 0.15 0.15 0.15 0.16 0.16 0.17 0.18 0.18 0.19 0.20 0.21 0.22 0.23 0.25 0.26 0.28 0.28 0.30 0.32 0.34 0.36 0.38 0.39 0.41 0.41 0.42 0.43 0.44 0.44 0.45 0.45 0.50 0.53 0.56 0.58 0.58 0.61 0.62 0.62 0.62 0.64 0.66 0.70 0.70 0.70 0.72 0.77 0.78 0.78 0.80 0.82 0.83 0.85 0.86 0.96 0.97 0.98 0.99 1.05 1.06 1.07 1.18 1.35 1.36 1.42 1.55 1.59 1.65 1.73 1.77 1.79 1.80 1.91 2.09 2.14 2.15 2.15 2.31 2.33 2.36 2.36 2.43 2.45 2.50 2.51 2.58 2.64 2.68 3.08 3.94 4.12 4.33 4.42 4.53 4.88 4.97 5.11 5.32 5.55 6.63 6.89 7.62 11.41 11.76 11.85 12.36 13.22];
% lifes = [1.901, 2.132, 2.203, 2.228, 2.257, 2.350, 2.361, 2.396, 2.397, 2.445, 2.454, 2.474, 2.518, 2.522, 2.525, 2.532, 2.575, 2.614, 2.616, 2.618, 2.624, 2.659, 2.675, 2.738, 2.740, 2.856, 2.917, 2.928, 2.937, 2.937, 2.977, 2.996, 3.030, 3.125, 3.139, 3.145, 3.220, 3.223, 3.235, 3.243, 3.264, 3.272, 3.294, 3.332, 3.346, 3.377, 3.408, 3.435, 3.493, 3.501, 3.537, 3.554, 3.562, 3.628, 3.852, 3.871, 3.886, 3.971, 4.024, 4.027, 4.225, 4.395, 5.020];
% lifes = [4.79, 4.75, 5.40, 4.70, 6.50, 5.30, 6.00, 5.90, 4.80, 6.70, 6.00, 4.95, 7.90, 5.40, 3.50, 4.54, 6.90, 5.80, 5.40, 5.70, 8.00, 5.40, 5.60, 7.50, 7.00, 4.60, 3.20, 3.90, 5.90, 3.40, 5.20, 5.90, 4.40, 5.20, 7.40, 5.70, 6.00, 3.60, 6.20, 5.70, 5.80, 5.90, 6.00, 5.15, 6.00, 4.82, 5.90, 6.00, 7.30, 7.10, 4.73, 5.90, 3.60, 6.30, 7.00, 5.10, 6.00, 6.60, 4.40, 6.80, 5.60, 5.90, 5.90, 8.60, 6.00, 5.80, 5.40, 6.50, 4.80, 6.40, 4.15, 4.90, 6.50, 8.20, 7.00, 8.50, 5.90, 4.40, 5.80, 4.30, 5.10, 5.90, 4.70, 3.50, 6.80];
% lifes = [0.040 0.301 0.309 0.557 0.943 1.070 1.124 1.248 1.281 1.281 1.303 1.432 1.480 1.505 1.506 1.568 1.615 1.619 1.652 1.652 1.757 1.795 1.866 1.876 1.899 1.911 1.912 1.914 1.981 2.010 2.038 2.085 2.089 2.097 2.135 2.154 2.190 2.194 2.223 2.224 2.229 2.300 2.324 2.349 2.385 2.481 2.610 2.625 2.632 2.646 2.661 2.688 2.823 2.890 2.902 2.934 2.962 2.964 3.000 3.103 3.114 3.117 3.166 3.344 3.376 3.385 3.443 3.467 3.478 3.578 3.595 3.699 3.779 3.924 4.035 4.121 4.167 4.240 4.255 4.278 4.305 4.376 4.449 4.485 4.570 4.602 4.663 4.694];
% lifes = [12,15,22,24,24,32,32,33,34,38,38,43,44,48,52,53,54,54,55,56,57,58,58,59,60,60,60,60,61,62,63,65,65,67,68,70,70,72,73,75,76,76,81,83,84,85,87,91,95,96,98,99,109,110,121,127,129,131,143,146,146,175,175,211,233,258,258,263,297,341,341,376];
% lifes = [0.08, 2.09, 3.48, 4.87, 6.94 , 8.66, 13.11, 23.63, 0.20, 2.23, 3.52, 4.98, 6.97, 9.02, 13.29, 0.40, 2.26, 3.57, 5.06, 7.09, 9.22, 13.80, 25.74, 0.50, 2.46 , 3.64, 5.09, 7.26, 9.47, 14.24, 25.82, 0.51, 2.54, 3.70, 5.17, 7.28, 9.74, 14.76, 26.31, 0.81, 2.62, 3.82, 5.32, 7.32, 10.06, 14.77, 32.15, 2.64, 3.88, 5.32, 7.39, 10.34, 14.83, 34.26, 0.90, 2.69, 4.18, 5.34, 7.59, 10.66, 15.96, 36.66, 1.05, 2.69, 4.23, 5.41, 7.62, 10.75, 16.62, 43.01, 1.19, 2.75, 4.26, 5.41, 7.63, 17.12, 46.12, 1.26, 2.83, 4.33, 5.49, 7.66, 11.25, 17.14, 79.05, 1.35, 2.87, 5.62, 7.87, 11.64, 17.36, 1.40, 3.02, 4.34, 5.71, 7.93, 11.79, 18.10, 1.46, 4.40, 5.85, 8.26, 11.98, 19.13, 1.76, 3.25, 4.50, 6.25, 8.37, 12.02, 2.02, 3.31, 4.51, 6.54, 8.53, 12.03, 20.28, 2.02, 3.36, 6.76, 12.07, 21.73, 2.07, 3.36, 6.93, 8.65, 12.63, 22.69];
% lifes = [0.1, 0.2, 1, 1, 1, 1, 1, 2, 3, 6, 7, 1,1, 12, 18, 18, 18, 18, 18, 21, 32, 36, 40, 45, 46, 47, 50, 55, 60, 63, 63, 67, 67, 67, 67, 72, 75, 79, 82, 82, 83, 84, 84, 84, 85, 85, 85, 85, 85, 86, 86];
% lifes = [0.762 0.761 0.676 0.644 0.588 0.555 0.537 0.536 0.514 0.511 0.509 0.501 0.499 0.495 0.493 0.487 0.485 0.477 0.467 0.459 0.450 0.446 0.444 0.441 0.440 0.440 0.435 0.435 0.424 0.420 0.420 0.412 0.411 0.411 0.404 0.402 0.398 0.398 0.394 0.392 0.390 0.389 0.387 0.380 0.380 0.379 0.378 0.373 0.371 0.367 0.361 0.361 0.357 0.356 0.355 0.354 0.351 0.347 0.339 0.332 0.326 0.324 0.324 0.323 0.320 0.309 0.291 0.279 0.279];
% lifes = [0.526 0.469 0.454 0.449 0.443 0.426 0.424 0.417 0.417 0.409 0.407 0.404 0.397 0.397 0.396 0.395 0.388 0.383 0.382 0.382 0.381 0.376 0.374 0.365 0.365 0.350 0.343 0.342 0.340 0.340 0.336 0.334 0.330 0.320 0.319 0.318 0.311 0.310 0.309 0.308 0.306 0.306 0.304 0.300 0.299 0.296 0.293 0.291 0.286 0.286 0.283 0.281 0.281 0.276 0.260 0.258 0.257 0.252 0.249 0.248 0.237 0.228 0.199];
% lifes = [86 146 251 653 98 249 400 292 131 169 175 176 76 264 15 364 195 262 88 264 157 220 42 321 180 198 38 20 61 121 282 224 149 180 325 250 196 90 229 166 38 337 65 151 341 40 40 135 597 246 211 180 93 315 353 571 124 279 81 186 497 182 423 185 229 400 338 290 398 71 246 185 188 568 55 55 61 244 20 284 393 396 203 829 239 236 286 194 277 143 198 264 105 203 124 137 135 350 193 188];
% lifes = [0.1, 0.2, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.0, 6.0, 7.0, 11.0, 12.0, 18.0, 18.0, 18.0, 18.0, 18.0, 21.0, 32.0, 36.0, 40.0, 45.0, 46.0, 47.0, 50.0, 55.0, 60.0, 63.0, 63.0, 67.0, 67.0, 67.0, 67.0, 72.0, 75.0, 79.0, 82.0, 82.0, 83.0, 84.0, 84.0, 84.0, 85.0, 85.0, 85.0, 85.0, 85.0, 86.0, 86.0];
lifes = [102, 148, 202, 156, 148, 150, 245, 235, 220, 214, 250, 220, 265, 275, 300, 300, 330, 350];
% lifes = [47, 331, 637.2, 218.7, 228, 614.9];

% the following three data are from the book "statistic analysis of
% reliabilty data" page 82
% lifes = [2.526 2.546 2.628 2.628 2.669 2.669 2.71 2.731 2.731 2.731 2.752 2.752 2.793 2.834 2.834 2.854 2.875 2.875 2.895 2.916 2.916 2.957 2.977 2.998 3.06 3.06 3.06 3.08];
% lifes = [2.485 2.526 2.546 2.546 2.567 2.628 2.649 2.669 2.71 2.731 2.752 2.772 2.793 2.793 2.813 2.813 2.854 2.854 2.854 2.895 2.916 2.936 2.936 2.957 2.957 3.018 3.039 3.039 3.039 3.08];
% lifes = [1.889 2.115 2.177 2.259 2.279 2.32 2.341 2.341 2.382 2.382 2.402 2.443 2.464 2.485 2.505 2.505 2.526 2.587 2.608 2.649 2.669 2.69 2.69 2.71 2.751 2.751 2.854 2.854 2.875];

[Obj, sol, output]=ABC_direct_throw_local_search_adaptive_qfrechet(1);
objMean = mean(Obj);
objStd = std(Obj);
solMean = mean(sol);
solStd = std(sol);

% fit normal distribution
pd = fitdist(lifes','Normal');
% print the negative log likelihood
negloglik(pd)


save comparison_Example;

q = solMean(1);
kse = solMean(2);
sigma = solMean(3);
t = 0:0.01:650;
y = (kse/sigma) * (t/sigma).^(-kse-1) .* (exp_q((-1/(2-q))*(t/sigma).^(-kse),q));
R = 1 - (1-((1-q)/(2-q))*(t./sigma).^(-kse)).^((2-q)/(1-q));
h = y./R;
cdf = 1 - R;

plot(t,h,'-');

xlabel('t');
ylabel('h_q(t)');
title('hazard rate');

% axis([0 200 0 200]);
% figure;plot(t(1:end-1),-diff(R)./diff(t)./R(1:end-1));

figure;
plot(t,cdf,'k--','LineWidth',1.2);
n = 6;
Fn = zeros(1,n+1);
for j = 0:n
    Fn(j+1,1) = j / n ;
end
cdfplot(lifes);

xlabel('Time');
ylabel('CDF');
title('');
legend('q-Frechet','Empirical CDF');

axis([0 650 0 1]);












